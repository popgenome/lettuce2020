##get gene sequence by HybPiper
hybpiper.sh

#method
Only read pairs where both reads passed these filters were retained. 
Recovered target sequences were assembled using HybPiper version version: 1.3.1
Reads were mapped to de-gapped medoid sequences using blast (blast-2.2.31), 
each gene was assembled de novo using SPAdes (3.12.0), and coding sequences were extracted using Exonerate (2.2.0). 
Non-coding sequences (i.e., introns and UTRs) flanking the coding sequences were recovered using the script intronerate.py available with HybPiper.
(article cite: A Universal Probe Set for Targeted Sequencing of 353 Nuclear Genes from Any Flowering Plant Designed Using k-Medoids Clustering)

#method cite:
1) HybPiper: Extracting Coding Sequence and Introns for Phylogenetics from High-Throughput Sequencing Reads Using Target Enrichment.
2) SPAdes: A New Genome Assembly Algorithm and Its Applications to Single-Cell Sequencing
3) Automated generation of heuristics for biological sequence comparison

### assembly
## assembly code
assembly.sh
##configuration file
lib.cfg

### annotation
## annotation code
annotation.sh
##perl code used in annotation
#nucleotide to protein
cds2aa.pl
#get cds sequence
getGene.pl
#masked repeat sequence
repeat_maksed_to_n.pl
#convert result to gff format
RepeatMasker.repeat_to_gff.pl
RepeatProteinMask.repeat_to_gff.pl
TRF.repeat_to_gff.pl
#configuration file
maker_bopts.ctl
maker_exe.ctl
maker_opts.ctl

#Repeat prediction method. 
Tandem Repeats Finder (Version 4.07b,Tandem repeats fnder: a program to analyze DNA sequences) was used to search for
tandem repeats. Both homology-based and de novo approaches were used to search for TEs. In the homology-based approach, we used
RepeatMasker (open-4.0.6,Using RepeatMasker to identify repetitive elements in genomic sequences) and RepeatProteinMask(vision 1.36,Using RepeatMasker to identify repetitive elements in genomic sequences) 
with the Repbase database of known repeat sequences to search for the TEs in the genome. In the de novo approach, we used RepeatModeler (open-1.0.8,De novo identifcation of repeat families in large genomes)
to construct a de novo repeat sequence database for genome and then used RepeatMasker to search for repeats in the genome. All
the repeats identified by different methods were combined into the final repeat
annotation after removing the redundant repeats.
(article cite: The hornwort genome and early land plant evolution)

#maker method
To predict protein-coding genes, three approaches were
used: (1) de novo gene prediction, (2) homology-based prediction, and (3)
RNA-sequencing annotation. For de novo prediction, AUGUSTUS (v.3.2.3,AUGUSTUS: ab initio prediction of alternative transcripts)
were applied to predict genes. For homologybased prediction, we mapped the protein sequences of five published green plant
genomes (Arabidopsis thaliana, SCynara_cardunculus, helianthus annuus, Lactuca sativa,
and Solanum lycopersicum) onto the genome using TBLASTN, with a
threshold E-value of 1×10−5.In regard to RNA sequencing-aided methods, we took the transcripts assembled by Bridger as evidence. 
In addition, GeneMark (v.1.0,GeneMark: web software for gene finding in prokaryotes, eukaryotes and viruses)65 was used to build a hidden Markov model based on genome sequence
The final consensus gene sets were generated by combining all the evidence using MAKER (v.2.31.8,MAKER-P: a tool kit for the rapid creation, management, and quality control of plant genome annotations)
(article cite: 1) The hornwort genome and early land plant evolution; 2) Genomes of early-diverging streptophyte algae shed light on plant terrestrialization)
#annotation code method cite:
1) Draft genome of the leopard gecko, Eublepharis macularius